# Theory
> Responders should not rush to kick an attacker out before theyâ€™ve got
> the full picture of what they were looking at and what has been exfiltrated
### Windows API Functions
<p>There has always been many ways to write memory to a process, but achieving it is much harder.</p>
<p>We want to strategically read a process memory, and write specifically to the executable portion.</p>
<p>We will use the following to do so.</p>

```c
ReadProcessMemory() && WriteProcessMemory();
```

### Process
**Step 1.** Define the structure of the process we want to read.\n
**Step 2.** Start the process in a suspended state.\n
**Step 3.** Grab the process environment block.\n
**Step 4.** Read this structure, grab the base address.\n
**Step 5.** Read the next 64 bytes, grab the DOS header.\n
**Step 6.** Read the DOS header, grab PE header.\n
**Step 7.** Read PE header, and FINALLY grab address of entry.\n
**Step 8.** Write our shellcode to the executable portion of code.\n
**Step 9.** Resume process, clean up.\n
