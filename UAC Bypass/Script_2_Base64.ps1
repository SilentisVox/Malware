function compress64($inputString) {
    # convert toarray
    $inputBytes = [System.Text.Encoding]::ASCII.GetBytes($inputString)

    # memory stream
    $memoryStream = New-Object System.IO.MemoryStream

    # deflate stream
    $deflateStream = New-Object System.IO.Compression.DeflateStream($memoryStream, [System.IO.Compression.CompressionMode]::Compress)

    # compress data
    $deflateStream.Write($inputBytes, 0, $inputBytes.Length)

    # close stream
    $deflateStream.Close()

    # convert to bas64
    $compressedBytes = $memoryStream.ToArray()
    $base64EncodedString = [Convert]::ToBase64String($compressedBytes)

    # return
    return $base64EncodedString
}
