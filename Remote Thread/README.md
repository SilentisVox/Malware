# Theory
> Parasites are nature's puppeteers, silently pulling the strings of their hosts, guiding them not with care, but for a performance designed solely for their own sinister symphony.

### Windows API Functions

<p>There has always been ways to leverage a process in the user's environment. Doing it will grant us stealth.</p>
<p>What we would like, is to find the process we want to leverage, and attach a thread to execute our code.</p>
<p>These are the functions to do so.</p>

```c
OpenProcess() && CreateRemoteThread();
```

### Process

<p><b>Step 1.</b> Find target process id.</p>
<p><b>Step 2.</b> Open a handle to the target process.</p>
<p><b>Step 3.</b> Allocate memory to be written within the target space.</p>
<p><b>Step 4.</b> Write shellcode to the allocated memory.</p>
<p><b>Step 5.</b> Create a remote thread to the process with the allocated memory</p>
<p><b>Step 6.</b> Keep Thread open for continuous execution.</p>

### Action
```c
// 1 FIND PROCESS ID
CreateToolhelp32Snapshot();
Process32FirstW(Snapshot);
processId = pe.th32ProcessID;
```
```c
// 2 OPEN HANDLE TO PROCESS
OpenProcess(pid)
```
```c
// 3 ALLOCATE MEMORY
VirtualAllocEx(Process, ShellcodeSize)
```
```c
// 4 WRITE SHELLCODE TO ALLOCATED MEMORY
WriteProcessMemory(Process, AllocatedMemory)
```
```c
// 5 CREATE REMOTE THREAD WITH NEW MEMORY
CreateRemoteThread(Process, (LPTHREAD_START_ROUTINE)AllocatedMemory)
```
```c
// 6 KEEP THREAD OPEN< CONTINUE EXECUTION
WaitForSingleObject(INFINTE)
```
